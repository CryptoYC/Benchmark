##  一、 概述
Cardano是从科学哲学开发出来的一个区块链项目，Ada是Cardano网络的代币，通过使用加密技术，可以快速，直接的转账，保证其安全性。Cardano不仅是一种加密货币，还是一个智能合约平台，该平台正在分层构建中，使系统更容易维护，并允许通过软分叉进行升级。在运行Ada的结算层构建完成后，将分离构建计算层来处理智能合约，这些数字法律协议将为未来的商业和业务提供支援。Cardano还将运行分散应用程序或DApp，服务将不是由任何一方控制，而是以区块链方式进行运作。

##  二、分析

### (一) 测试说明

我们在AWS上在全球部署了了若干个Kubernetes节点，用以模拟Cardano网络的环境，具体测试环境如下：

![Kubernetes Test env](https://github.com/EVOLABTeam/benchmark/blob/master/result/md/asset/img/Kubernetes%20%20Test%20env.png)

### (二) 共识
Cardano采用一种革命性新权益证明算法，称为乌洛波罗斯，它决定了各个节点如何达成网络的一致性。在工作量证明中，矿工投入运算能力来竞争被选为领先者，以获得生成下一个区块的权力和赢得奖励。相较之下，在权益证明中，依照区块链帐簿，随机选取组成下ㄧ个区块的股权者，此机率与股权者拥有之股权比例成正比。为了确保区块链的安全性，选择股权者来制作区块的方法必须是真正随机的。为了产生领导者选举过程的随机性，乌洛波罗斯的创新是通过安全、多方执行掷硬币协议来达成这点。

- 要解决的问题：出块权的分配，即谁来出块？    
  乌洛波罗斯权益证明算法，是一种区别于PoW算力竞争的共识算法，能耗较低。采用随机算法决定出块权的分配，类似掷骰子。
  该算法的基本要素是：
  1. 需要选出谁拥有出块权
  2. 通过随机数决定谁来出块，但概率与持币数量成正比。
  3. 让其他人知道并认可该结果，即『证明』交易块是合法的。
  4. 开始下一个出块权的竞选，并保持随机性。

- 如何去选择：具备出块权的节点谁来当？ 

乌洛波罗斯权益证明算法中提出了一些概念，需要先清楚：

『epochs』乌洛波罗斯协议将物理的时间划分为 epochs, 每一个 epoch 又划分为 slots。可以理解类似：1年为一个时节段，该时间段分12月。

『slot』每个 slot 有且只有一个领导者，slot 领导者有权在他的 slot 内生成一个区块。

『slot 领导者』：一个节点最终被选中来在该slot内可出块。（类似比特币中的矿工）

『候选人』：Slot 领导者从所有的权益所有人中选举。只有有足够多的权益（比如，总量的2%)才有资格成候选人。

『具有股权的人』：被称为权益所有人，权益所有人必须被选举为 slot 领导者才可在区块链生成区块。

『公平抽签』  epoch 的选举中会选举一个 slot 领导者参与下一次 epoch。因此，在 epoch N 结束的时候，我们就能知道 epoch N+1 的 slot 领导者是谁，并且这是不可更改的。

乌洛波罗斯权益证明算法分为三个阶段：抽签选举、提交阶段、开启阶段、公布阶段
  1. 抽签选举： 为 保证模拟真正的“抽签”，采用多方计算（multiparty computation (MPC) ）方法用来实现这个随机性，每个参选人独立进行一次『投硬币』的行为，然后与其他参选人分享结果。

  2. 提交阶段：在该阶段参选人分享自己的结果，所以每个参选需要一个“提交”,类似一个黑盒子。提交需要包含三个部分： 参选人会产生一个密钥（特殊的随机值）、当前epoch的编号、候选人的公钥，最后用参选人的密钥签署该提交。

    注：在这种情况下，每个人都可以知道谁创建了这个提交，以及这个提交属于哪个epoch。 

  3. 开启阶段：参选人会将其“提交”交给其他参选人，最终每个参选人都会拿到其他参选人的提交，并可选择“开启”来确认匹配到的值，而每个候选人在『公平抽签』时，选取的随机值来自于该epoch内的币所属地址。 


  4. 公布阶段：这是最后的阶段。最终，参选者既有提交，也有开启。从理论上来说，一些选民会成为对手。所以它可以公布它的提交，但不公开它的开启。在这种情况下，诚实的选民（协议的基本假设前提是大多数 50%+1都是诚实的 ）可以公布开启，即使某些选民是对手，选举也能成功结束。开启匹配，如果成功，从提交中提取密钥，并从这些密钥中形成种子（随机生成的字符串）所以所有的选民都会得到相同的种子，并且会被用于追随中本聪算法FTS。FTS 是一个挑选币的可证算法，当权益所有人 S 的币被选中时，S 就成为一个 slot 领导者。很明显，S 的币越多，他的币被选中的几率也就越大。


### (三) 安全
通过Benchmark公链测试工具，对Cardano进行一系列安全测试，包括DDos攻击、长程攻击、短程攻击、网络分裂攻击等，我们的测试方法如下:

1.  建立Cardano测试网；

2.  发送RPC，让测试网部分节点对其他节点发起攻击；

3.  得到测试结果。

| 方案         | 结果   | 备注                                                                     |
|--------------|--------|--------------------------------------------------------------------------|
| DDoS攻击     | 通过   | 以大量的通信量冲击网络，使得所有可用网络资源都被消耗殆尽                 |
| 长程攻击     | 通过   | 攻击者创建了一条从创世区块开始的长区块链分支，并试图替换掉当前的合法主链 |
| 短程攻击     | 通过   | 攻击者篡改最近几个区块的数据                                             |
| 网络分裂攻击 | 不通过 | 把网络分成两个或多个部分，使得在较小的链上进行的任何重复交易都将丢失     |

从DDos攻击测试结果可知，攻击者可以向全部或51％的Cardano节点发送DDoS攻击，Cardano网络能够使用。

从长程攻击测试结果可知，攻击者无法创建了一条从创世区块开始的长区块链分支。

从短程攻击测试结果可知，攻击者无法篡改Cardano网络最近几个区块的数据，以替换掉当前的合法主链。

从网络分裂攻击测试结果可知，在发生网络分裂攻击后，在网络恢复正常之前，在较小的链上进行的任何重复交易都将丢失。

从上可知，Cardano网络的安全性相当好。

### (四) 性能
通过Benchmark公链测试工具，对Cardano进行性能测试，我们的测试方法如下：

1.  建立Cardano测试网；

2.  发送RPC，让测试网部分节点发起交易（每秒N笔交易，线性增长）；

3.  节点检测交易同步的时间，直到检测到超过一定时间（一般是出块时间）。

| 方案         | TPS | 备注                              |
|--------------|-----|-----------------------------------|
| 理想网络情况 | 7   | 单机虚拟机网络，无限网络连接      |
| 正常网络情况 | 5   | 分布全球的100个节点，正常网络连接 |
| 恶劣网络情况 | 2   |                                   |

即使在理想网络情况下，Cardano网络只有7TPS，性能是比较差，原因在于满足系统的安全性和去中心化，而牺牲掉性能。

### (五) 技术创新
Cardano的创新性地借鉴了TCP /
IP的设计思路，设计出了分层的协议架构，一个是结算层，处理 Cardano
网络的代币交易、清算等工作，可以理解为一个类似比特币的账本体系。另一个是计算层，处理
Cardano的智能合约、身份认证、消息通信，并支持开发 DApp。

### (六) 代码

Cardano是由IOHK联合爱丁堡大学，雅典大学和康涅狄格大学共同设计开发，并开源在IOHK的Github仓库。

1.  代码概况

-   Cardano的主要Github仓库的具体数据如下:

| repository      | commit | watch | star | fork | issue |
|-----------------|--------|-------|------|------|-------|
| cardano-sl      | 16807  | 411   | 3256 | 561  | 160   |
| cardano-prelude | 92     | 60    | 2    | 0    | 1     |
| cardano-wallet  | 1051   | 10    | 21   | 13   | 4     |
| cardano-js-sdk  | 80     | 6     | 3    | 0    | 7     |
| cardano-ledger  | 824    | 62    | 36   | 11   | 27    |

1.  代码更新

根据Cardano的cardano-sl的Github commits数据，得到cardano-sl的代码更新情况，如下:




### (七) 经济模型
  Cardano的激励机制跟现有的大多数公有链类似，“矿工”收取交易手续费。与比特币不同，交易手续费是
Cardano矿工的唯一收入来源。而且交易手续费不仅是给矿工的激励，也是一种防止 DDoS
攻击的手段，当攻击者试图用大量伪造交易冲击网络时，必须付出足够多的手续费。

##  总结


Cardano并没有从全面蓝图开始，甚至没有一个权威的白皮书。相反地，它包含一系列的原则，工程最佳实践和探索途径。Cardano更像是结合其他项目的优点，规避其他项目的缺点而诞生的一个平台。
